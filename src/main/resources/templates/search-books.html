<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Book Club</title>
  <link th:rel="stylesheet" th:href="@{/webjars/bootstrap/5.2.3/css/bootstrap.min.css}">
</head>
<body class="dark">
<!-- Include the navbar fragment -->
<div th:insert="common/navbar :: navbar"></div>
<div class="container">
  <h1>Search for a book</h1>
  <form method="post" action="/book">
    <div class="input-group mb-3">
      <input type="text" name="search" class="form-control" placeholder="Enter book title or author" aria-label="Enter book title or author">
      <button type="submit" class="btn btn-primary">Search</button>
    </div>
  </form>
  <h2>Results</h2>
  <table class="table table-striped">
    <thead>
    <tr>
      <th>Title</th>
      <th>Author</th>
      <th>ISBN</th>
      <th></th>
    </tr>
    </thead>
    <tbody>
    <tr th:each="item: ${books}">
        <td th:text="${item.Title}"></td>
        <td th:text="${item.Author}"></td>
        <td th:text="${item.Isbn}"></td>
        <td><button type="button" class="btn btn-primary" name="book" th:value="${item.Isbn}" id="add-to-library-button">Add to Library</button></td>
    </tr>
    </tbody>
  </table>
</div>
<!-- jQuery and Bootstrap Bundle (includes Popper) -->
<script th:src="@{/webjars/jquery/3.6.0/jquery.min.js}"></script>
<script th:src="@{/webjars/bootstrap/5.2.3/js/bootstrap.bundle.min.js}"></script>

<script>
const addToLibraryButton = document.getElementById("add-to-library-button");

addToLibraryButton.addEventListener("click", () => {
  const bookItem = addToLibraryButton.value;
  const formData = new FormData();
  formData.append("bookItem", bookItem);

  fetch("/addBook", {
    method: "POST",
    body: formData,
  })
  .then(response => response.json())
  .then(data => console.log(data))
  .catch(error => console.error(error));
});
</script>
</body>
</html>